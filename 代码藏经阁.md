# ä»£ç è—ç»é˜
è¿™ä¸ªæ˜¯å¼€å‘MODæ—¶å®éªŒçš„ä¸€äº›ä»£ç ç‰‡æ®µï¼Œå¤§å¤šæ•°éƒ½æ²¡æœ‰ä»€ä¹ˆç”¨ï¼Œåªæ˜¯ä¸ºäº†è®°å½•ä¸€ä¸‹å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜ã€‚

æˆ‘ä¸çŸ¥é“åç»­ä¼šä¸ä¼šç”¨åˆ°ï¼Œæ‰€ä»¥è®°å½•ä¸‹æ¥ï¼Œä½œä¸ºå¤‡å¿˜å½•ã€‚

è¿™ä¸ªæ–‡ä»¶å³ä½¿åœ¨modé‡Œï¼Œæ¸¸æˆä¹Ÿä¸ä¼šè¯†åˆ«æˆ–è€…åŠ è½½ã€‚

æ³¨ï¼šä»¥ä¸‹æ‰€æœ‰æ–‡ä»¶éƒ½å¿…é¡»æ˜¯ utf-8 with BOM ç¼–ç ï¼Œå¦åˆ™æ¸¸æˆä¼šæŠ¥é”™ã€‚

## äº‹ä»¶ event
äº‹ä»¶å­˜æ”¾ç›®å½•ï¼šin_game/events/ [æ–‡æ¡£](https://eu5.paradoxwikis.com/Event_modding)

æ–‡ä»¶ä»¥xxx.txtå‘½åï¼Œeg: tiandao_rename.txt

æ¯ä¸ªäº‹ä»¶æ–‡ä»¶é‡Œéƒ½å¿…é¡»æœ‰ä¸€ä¸ªä¸”åªèƒ½æœ‰ä¸€ä¸ªnamespaceï¼Œæ‰€æœ‰äº‹ä»¶éƒ½å¿…é¡»åœ¨è¿™ä¸ªnamespaceé‡Œï¼Œä»¥å®ƒä½œä¸ºå‘½åç©ºé—´ï¼Œeg: namespace = tests_event

äº‹ä»¶å‘½åæ ¼å¼ï¼šnamespace.äº‹ä»¶IDã€‚æ¸¸æˆä¼šåŠ è½½æ‰€æœ‰çš„äº‹ä»¶åˆ—è¡¨ï¼Œæ¯ä¸ªäº‹ä»¶éƒ½å¿…é¡»æœ‰ä¸€ä¸ªå”¯ä¸€çš„IDï¼Œeg: tests_event.1, tests_event.2ã€‚å¦‚æœäº‹ä»¶åé‡å¤ï¼Œæ¸¸æˆä¼šä»¥æœ€ååŠ è½½çš„è¦†ç›–å‰é¢åŠ è½½çš„ã€‚

æ‰€ä»¥å¦‚æœæ¸¸æˆå†…éƒ¨æœ‰ä¸€ä¸ªäº‹ä»¶åï¼ša.1, é‚£æˆ‘åœ¨modä¸­å†™ä¸€ä¸ªäº‹ä»¶åä¹Ÿå«a.1, æ¸¸æˆä¼šä»¥modä¸­çš„äº‹ä»¶ä¸ºå‡†,å› ä¸ºmodçš„åŠ è½½ä¼šåœ¨æ¸¸æˆäº‹ä»¶åŠ è½½ä¹‹åã€‚

å‘½åç©ºé—´ä¸€å®šè¦æœ‰ï¼Œä½†æ˜¯äº‹ä»¶å‘½åå¯ä»¥ä¸ä¸€å®šéè¦ä»¥å‘½åç©ºé—´å¼€å¤´ï¼Œeg: tests_event.1 / a.1, å¦‚æœæ¸¸æˆä¸­å·²ç»å­˜åœ¨aå‘½åç©ºé—´ï¼Œa.1å°±æœ‰ç”¨ï¼Œå¦åˆ™a.1è¿™ä¸ªäº‹ä»¶æ— æ•ˆã€‚

æ¸¸æˆåªä¼šåŠ è½½äº‹ä»¶åˆ—è¡¨ï¼Œä¸å…³å¿ƒäº‹ä»¶çš„æ–‡ä»¶åï¼Œæ‰€ä»¥ä»€ä¹ˆæ–‡ä»¶åéƒ½å¯ä»¥ï¼Œä½†æ˜¯æ¨èè§„èŒƒèµ·åï¼Œeg: tiandao_rename.txt, äº‹ä»¶åå°±å†™ tiandao_rename.1, tiandao_rename.2ã€‚ç»´æŠ¤èµ·æ¥æ–¹ä¾¿ã€‚

```txt
# å‘½åç©ºé—´å£°æ˜
namespace = tests_event
# äº‹ä»¶ç¼–å†™
tests_event.1 = { # å…·ä½“å†…å®¹ }
tests_event.2 = { # å…·ä½“å†…å®¹ }
# å¯ä»¥å†™ï¼Œä½†æ˜¯æ— æ•ˆï¼Œå› ä¸ºæ²¡æœ‰æŒ‡å®šnamespace
# å¦‚æœæ¸¸æˆä¸­å·²ç»å­˜åœ¨aå‘½åç©ºé—´namespace = a, é‚£ä¹ˆa.1å°±ä¼šè¦†ç›–æ¸¸æˆä¸­çš„a.1äº‹ä»¶,è¿™ä¸ªäº‹ä»¶å°±æœ‰ç”¨äº†ã€‚
a.1 = { # å…·ä½“å†…å®¹ }
```

ä¸€ä¸ªåŸºç¡€çš„äº‹ä»¶ç»“æ„ï¼š

```txt
tests_event.1 = {
    type = country_event # äº‹ä»¶ç±»å‹ å‘Šè¯‰æ¸¸æˆè¿™ä¸ªäº‹ä»¶æ˜¯å›½å®¶çš„è¿˜æ˜¯è§’è‰²çš„ï¼Œæˆ–è€…å…¶ä»–çš„
    title = "" # äº‹ä»¶æ ‡é¢˜ï¼Œä¼šæ˜¾ç¤ºåœ¨äº‹ä»¶èœå•é‡Œ
    immediate = {} # ç«‹å³æ‰§è¡Œçš„ä»£ç ï¼Œä¼šåœ¨äº‹ä»¶è§¦å‘æ—¶ç«‹å³æ‰§è¡Œ
    desc = "" # äº‹ä»¶æè¿°
    # é€‰é¡¹ï¼Œæ¯ä¸ªé€‰é¡¹éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„äº‹ä»¶ï¼Œç‚¹å‡»åä¼šæ‰§è¡Œå¯¹åº”çš„ä»£ç 
    option = {
        name = "å…³é—­" # é€‰é¡¹åå­—
        # è¿™é‡Œå¯ä»¥æ‰§è¡Œä¸€äº›å…¶ä»–å†…å®¹
    }
}
```

äº‹ä»¶å®éªŒè®°å½•:
```txt
## çš‡å¸æ”¹åæˆåŠŸäº†
tests_event.111 = {
    type = country_event
    title = "ç»Ÿæ²»è€…ä¿¡æ¯æ·±åº¦æ‰«æ"
    immediate = {
        # å¼ºåˆ¶æŠ“å–å½“å‰å›½å®¶çš„ç»Ÿæ²»è€…
        if = {
            limit = { has_ruler = yes }
            ruler = {
                save_scope_as = debug_target
            }
        }
    }
    # å¦‚æœæ”¹åæˆåŠŸï¼Œè¿™ä¸ª desc ä¼šæ˜¾ç¤ºæ–°çš„åå­—
    desc = "æ‰§è¡Œå®Œæ¯•ã€‚å°è¯•æ¢æµ‹åˆ°çš„è§’è‰²åä¸ºï¼š[scope:debug_target.GetName]"
    option = {
        name = "æ£€æŸ¥æ§åˆ¶å°æ—¥å¿—"
        # è¿™ä¸€è¡Œä¼šå°† debug_target çš„æ‰€æœ‰å±æ€§å¼ºè¡Œåˆ·åœ¨ error.log é‡Œ
        debug_breakpoint = yes
    }
}
#çš‡å¸æ”¹åæˆåŠŸäº†
tests_event.112 = {
    type = country_event
    title = "ç»Ÿæ²»è€…ä¿¡æ¯æ·±åº¦æ‰«æ"
    immediate = {
        ruler = { save_scope_as = current_monarch }
    }
    desc = "[ruler]"
    option = {
        name = "ç‚¹å‡»å°è¯•ç»™ç»Ÿæ²»è€…æ”¹å"
        scope:current_monarch = {
            set_first_name = "å…ƒç’‹"
        }
    }
    option = {
        name = "ç¡®å®š"
    }
}
# ä¸¤ä¸ªåŠæ³•éƒ½èƒ½æ”¹ç»§æ‰¿äººï¼Œä½†æ˜¯åªæœ‰è°ƒè¯•ä¿¡æ¯é‡Œçœ‹åˆ°æˆåŠŸäº†
tests_event.113 = {
    type = country_event
    title = "ç»§æ‰¿äººä¿¡æ¯æ·±åº¦æ‰«æ"
    immediate = {
        heir = { save_scope_as = current_monarch }
    }
    # æˆ‘ä»¬æ¢å‡ ç§ä¸åŒçš„å†™æ³•ï¼Œçœ‹å“ªä¸€è¡Œä¸æ˜¾ç¤º ERROR
    desc = "[heir]"
    option = {
        name = "ç‚¹å‡»å°è¯•ç»™ç»§æ‰¿äººæ”¹å"
        scope:current_monarch = {
            set_first_name = "é˜¿æ ‡1"
        }
    }
    option = {
        name = "å¼ºåŠ›æ”¹åï¼šé™é•œ1"
        # ç›´æ¥é€šè¿‡å›½å®¶ä½œç”¨åŸŸå¯¹ heir æ”¹å
        heir = {
            set_first_name = "é˜¿æ ‡2"
        }
    }
    option = {
        name = "ç¡®å®š"
    }
}
# æŒ‡å®šè€äºŒæ”¹å
tests_event.115 = {
    type = country_event
    title = "çš‡æ—æˆå‘˜åå•"
    immediate = {
        # 1. è¿›é—¨å…ˆæ¸…ç©ºæ‰€æœ‰ç›¸å…³æ ‡è®°ï¼Œç¡®ä¿æœ¬æ¬¡æœç´¢æ˜¯å…¨æ–°çš„
        remove_variable = second_child_found
        ruler = {
            every_child = {
                limit = {
                    is_alive = yes
                    is_heir = no
                    # æ ¸å¿ƒé˜²çº¿ï¼šå¦‚æœå›½å®¶å·²ç»è®°å½•ä¸‹â€œæŠ“åˆ°äººäº†â€ï¼Œåé¢çš„å­©å­å°±ä¸å†è¿›å…¥é€»è¾‘
                    root = { NOT = { has_variable = second_child_found } }
                }
                # åªæœ‰æ‰«æåˆ°çš„ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„å­©å­ï¼ˆè€äºŒï¼‰èƒ½è¿›åˆ°è¿™é‡Œ
                save_scope_as = second_child
                # ç«‹åˆ»åœ¨å›½å®¶ï¼ˆrootï¼‰å±‚çº§æ‰“ä¸Šæ°¸ä¹…çƒ™å°ï¼Œå…³ä¸Šä¸Šé¢ limit çš„å¤§é—¨
                root = { set_variable = second_child_found }
            }
        }
    }
    desc = "å“ˆå“ˆå“ˆ"
    option = {
        name = "ç»™è€äºŒèµå"
        scope:second_child = {
            set_first_name = "é™é•œ"
        }
        # 5. å…³é”®ï¼šç‚¹å‡»æŒ‰é’®åç«‹åˆ»æ¸…é™¤æ ‡è®°ï¼Œé˜²æ­¢å˜é‡å †ç§¯åœ¨å­˜æ¡£é‡Œ
        remove_variable = second_child_found
    }
    option = {
        name = "å–æ¶ˆ"
        remove_variable = second_child_found
    }
}
# è€ä¸‰ä¸“ç”¨ ç¼ºé™·ç‰ˆ
tests_event.1 = {
    type = country_event
    title = "çš‡æ—æˆå‘˜åå• - è€ä¸‰ä¸“ç”¨"
    is_triggered_only = yes
    immediate = {
        ruler = {
            # ç›´æ¥æŒ‰å¹´é¾„é™åºæ‰¾ç¬¬ä¸‰ä¸ªå­©å­
            random_child = {
                limit = { is_alive = yes }
                order_by = age  # é»˜è®¤é™åºï¼šå¹´é¾„æœ€å¤§çš„æƒé‡æœ€é«˜
                position = 2    # ç´¢å¼•ä»0å¼€å§‹ï¼Œ2å°±æ˜¯ç¬¬ä¸‰ä¸ª
                save_scope_as = target_child_3
            }
        }
    }
    desc = "å½“å‰å®šä½çš„çš‡ä¸‰å­æ˜¯ï¼š[scope:target_child_3.GetFirstName]"
    option = {
        name = "ä¸ºè€ä¸‰èµåï¼šé™é•œ2"
        trigger = {
            exists = scope:target_child_3
        }
        scope:target_child_3 = {
            set_first_name = "é™é•œ2"
        }
    }
    option = {
        name = "å–æ¶ˆ"
    }
}
# æ‹¿ç»§æ‰¿äººçš„åå­—
tests_event.2 = {
    type = character_event   # å¿…é¡»æ˜¯è§’è‰²äº‹ä»¶
    title = "å¿«æ·æ”¹åå·¥å…·"
    is_triggered_only = yes
    immediate = {
        heir = { save_scope_as = current_monarch }
    }
    desc = "å½“å‰é€‰ä¸­çš„è§’è‰²ï¼š[root.GetName] (ID: [root.GetID])"
    option = {
        name = "æ”¹åä¸ºï¼šé™é•œ_å®šå‘"
        root = {
            set_first_name = "é™é•œ_å®šå‘"
        }
    }
    option = {
        name = "å–æ¶ˆ"
    }
}
# å¤šä¸ªé€‰é¡¹è°ƒç”¨å…¶ä»–ä¸åŒçš„äº‹ä»¶
tests_event.200 = {
    type = character_event
    title = "é€‰æ‹©ä¸€ä¸ªåå­—"
    desc = "è¯·é€‰æ‹©åå­—"
    option = {
        name = "ã€é‡‘ã€‘å­—è¾ˆ"
        trigger_event = { id = tests_event.201 }
    }
    option = {
        name = "ã€æœ¨ã€‘å­—è¾ˆ"
        trigger_event = { id = tests_event.202 }
    }
    option = {
        name = "ã€æ°´ã€‘å­—è¾ˆ"
        trigger_event = { id = tests_event.201 }
    }
    option = {
        name = "ã€ç«ã€‘å­—è¾ˆ"
        trigger_event = { id = tests_event.204 }
    }
    option = {
        name = "ã€åœŸã€‘å­—è¾ˆ"
        trigger_event = { id = tests_event.205 }
    }
    option = {
        name = "å…¶ä»–åå­—"
        trigger_event = { id = tests_event.206 }
    }
    option = {
        name = "ã€éšæœºæ‹Ÿå®šã€‘"
        scope:recipient = {
            random_list = {
                10 = { set_first_name = "å…ƒç’‹" }
                10 = { set_first_name = "æ££" }
            }
        }
    }
    # è¿™é‡Œçš„ footer æ•ˆæœï¼šå›ºå®šåœ¨ä¸»ç•Œé¢æœ€ä¸‹æ–¹
    option = {
        name = "å…¹äº‹ä½“å¤§ï¼Œæœ•å†è€ƒè™‘ä¸€ç•ª"
    }
}
# å¤šä¸ªé€‰é¡¹ç›´æ¥ä¿®æ”¹
tests_event.3 = {
    type = character_event
    title = "é€‰æ‹©ä¸€ä¸ªåå­—"
    desc = "é€‰æ‹©ä¸€ä¸ªåå­—"
    option = {
        name = "a"
        scope:recipient = {
            newborn_message_popup = yes
        }
    }
    option = {
        name = "å…ƒç’‹"
        scope:recipient = {
            set_first_name = "å…ƒç’‹"
        }
    }
    option = {
        name = "æ¨‰"
        scope:recipient = {
            set_first_name = "æ¨‰"
        }
    }
    option = {
        name = "æ£¡"
        scope:recipient = {
            set_first_name = "æ£¡"
        }
    }
    option = {
        name = "æ££"
        scope:recipient = {
            set_first_name = "æ££"
        }
    }
    option = {
        name = "æ©š"
        scope:recipient = {
            set_first_name = "æ©š"
        }
    }
    option = {
        name = "é™é•œ"
        scope:recipient = {
            set_first_name = "é™é•œ"
        }
    }
    # å¿…é¡»æœ‰ä¸€ä¸ªé€‰é¡¹ï¼Œå¦åˆ™äº‹ä»¶å¼¹å‡ºæ¥å…³ä¸æ‰
    option = {
        name = "å…¹äº‹ä½“å¤§ï¼Œæœ•å†è€ƒè™‘ä¸€ç•ª"
    }
}
tests_event.4 = {
    type = character_event
    title = "éº»ç“œ-æ•°å­—è¿ç‚¹å™¨"
    immediate = {
        # ä¿å­˜å½“å‰è§’è‰²åˆ°å˜é‡ my_target_char
        scope:recipient = {
            save_scope_as = my_target_char
        }
        if = {
            limit = { NOT = { has_global_variable = pinyin_code } }
            set_global_variable = {
                name = pinyin_code
                value = 0
            }
        }
    }
    desc = "
    å½“å‰è§’è‰²ï¼š [my_target_char.GetName]
    [recipient.GetName]
    å½“å‰è¾“å…¥ä»£ç ï¼š
    # [Root.var:aa.GetName]
    # [ROOT.GetVariable('aa').GetName]
    [GetGlobalVariable('pinyin_code').GetValue]
    [ROOT.GetVariable('a').GetValue]
    "
    option = {
        name = "æ‹›å‹Ÿå¾è¾¾"
        # åœ¨å½“å‰å›½å®¶ï¼ˆROOTï¼‰åˆ›å»ºè§’è‰²
        create_named_dynasty = xu_dynasty
        create_character = {
            mil = { 80 100 }
			adm = { 80 100 }
			dip = { 80 100 }
            dynasty = dynasty:xu_dynasty
            first_name = "è¾¾"            # å¦‚æœä½ å·²ç»å®šä¹‰äº†å¾è¾¾çš„æœ¬åœ°åŒ–Keyï¼Œå¯ä»¥å†™ Xu_Da
            age = 32                # è®¾ç½®å¹´é¾„
            is_female = no          # æ€§åˆ«
            culture = root.culture  # ç»§æ‰¿å›½å®¶çš„æ–‡åŒ–
            religion = root.religion # ç»§æ‰¿å›½å®¶çš„å®—æ•™
            # å¦‚æœä½ æƒ³è®©ä»–å…·å¤‡ç‰¹å®šçš„æ­¦å°†ç‰¹è´¨ï¼ˆå‚è€ƒ modifiers.logï¼‰
            traits = { great_general }
            # è®©ä»–æˆä¸ºä½ çš„å°†é¢†æˆ–å®˜å‘˜ ï¼ˆæ— æ•ˆï¼‰
            # save_scope_as = xu_da_scope
        }
        # å¦‚æœéœ€è¦å°†ä»–ç«‹å³ä»»å‘½ä¸ºå°†é¢†ï¼ˆå‡è®¾ä½ æƒ³è®©ä»–å¸¦å…µï¼Œ æ— æ•ˆï¼‰
        # assign_as_general = scope:xu_da_scope
    }
    # æ•°å­— 0 é”®
    option = {
        name = "æµ‹è¯•åŠ¨æ€åå­—"
        scope:recipient = {
            # æœ¬åœ°åŒ–keyæ”¯æŒ.é“¾æ¥ä½¿ç”¨
            set_first_name = name_lin.name_er.name_a1
            # æ˜µç§°
            set_nickname = ""
        }
    }
    # æ•°å­— 0 é”®
    option = {
        name = "0"
        scope:recipient = { input_number_digit = { DIGIT = 0 } }
        trigger_event_non_silently = { id = tests_event.4 }
    }
    # æ•°å­— 1 é”®
    option = {
        name = "1"
        scope:recipient = { input_number_digit = { DIGIT = 1 } }
        trigger_event_non_silently = { id = tests_event.4 }
    }
    # æ•°å­— 2 é”®
    option = {
        name = "2"
        scope:recipient = { input_number_digit = { DIGIT = 2 } }
        trigger_event_non_silently = { id = tests_event.4 }
    }
    # æ•°å­— 3 é”®
    option = {
        name = "3"
        scope:recipient = { input_number_digit = { DIGIT = 3 } }
        trigger_event_non_silently = { id = tests_event.4 }
    }
    # æäº¤æŒ‰é’®ï¼šå½“åºåˆ—åŒ¹é…æ—¶å‡ºç°
    option = {
        name = "é€‰å¥½äº†"
        trigger_event_non_silently = { id = tests_event.5 }
    }
    option = {
        name = "å…¹äº‹ä½“å¤§ï¼Œæœ•å†è€ƒè™‘ä¸€ç•ª"
        remove_global_variable = pinyin_code
    }
}
tests_event.5 = {
    type = character_event
    title = "æ‹¼éŸ³è¾“å…¥æ³•"
    desc = "å½“å‰è¾“å…¥ä»£ç ï¼š[GetGlobalVariable('pinyin_code').GetValue]"
    option = {
        name = "ä½ å¥½" # å…¨å±€å˜é‡pinyin_codeç­‰äº1111æ—¶æ˜¾ç¤º
        trigger = {global_var:pinyin_code = 1111}
        scope:recipient = {set_first_name = "ä½ å¥½" remove_global_variable = pinyin_code}
    }
    option = {
        name = "å¥½å—"
        trigger = { global_var:pinyin_code = 1112}
        scope:recipient = {set_first_name = "å¥½å—" remove_global_variable = pinyin_code}
    }
    option = {
        name = "å…¹äº‹ä½“å¤§ï¼Œæœ•å†è€ƒè™‘ä¸€ç•ª"
        remove_global_variable = pinyin_code
    }
}
namespace = manual_rename_fix
# aiè¾“å‡ºçš„åºŸæ¡ˆä»£ç ï¼Œæ²¡ä¸€ä¸ªæœ‰æ•ˆçš„
# character:33574460 æ ¼å¼ä¹Ÿæ˜¯ä¸å¯¹çš„ï¼Œç›®å‰æ²¡æœ‰æ‰¾åˆ°èƒ½ç›´æ¥é€šè¿‡è§’è‰²idæŒ‡å®šè§’è‰²èŒƒå›´çš„
manual_rename_fix.1 = {
	type = character_event
	title = "å®—å®¤æ›´åç»ˆææ–¹æ¡ˆ"
	desc = "å¦‚æœæ™®é€šæŒ‡ä»¤æ— æ•ˆï¼Œè¯·å°è¯•å¼ºåˆ¶äº¤äº’æ¨¡å¼ã€‚"
	illustration_tags = {
		10 = angry
		10 = interior
	}
	# æ–¹æ¡ˆä¸€ï¼šåˆ©ç”¨ Jomini å¼•æ“çš„åº•å±‚äº¤äº’å¼¹å‡º (æœ€æ¨è)
	option = {
		name = "1. è°ƒå‡ºåŸç”Ÿæ”¹åçª—å£"
		# è¿™ä¸€è¡Œå¦‚æœç”Ÿæ•ˆï¼Œä¼šç›´æ¥è·³å‡ºæ¸¸æˆè‡ªå¸¦çš„è¾“å…¥æ¡†
		character:33574460 ?= {
			set_first_name = "wu"
		}
	}
	# æ–¹æ¡ˆäºŒï¼šå¼ºåˆ¶å˜é‡è¦†ç›–
	option = {
		name = "2. å¼ºåˆ¶å˜é‡åˆ·æ–°æ”¹å"
		character:33574460 ?= {
			set_first_name = "wu_culture"
		}
	}
	# æ–¹æ¡ˆä¸‰ï¼šç›´æ¥é’ˆå¯¹ root ä½œç”¨åŸŸ (æ§åˆ¶å°ä¼ å‚)
	option = {
		name = "3. å¦‚æœèƒ½å¼¹å‡º.2è¯´æ˜character:33574460è¿›å…¥äº†"
		character:33574460 ?= {
			character_event = { id = manual_rename_fix.2 }
		}
	}
}
manual_rename_fix.2 = {
	type = character_event
	title = "æ‰§è¡ŒæˆåŠŸï¼"
	desc = "å½“ä½ çœ‹åˆ°è¿™ä¸ªå¼¹çª—æ—¶ï¼Œè¯æ˜ä¸Šä¸€ä¸ªé€‰é¡¹é‡Œçš„ä»£ç å·²ç»å…¨éƒ¨è·‘å®Œäº†ã€‚"
	option = { name = "å¤ªæ£’äº†" }
}
manual_rename_fix.3 = {
	type = country_event
	is_triggered_only = yes
	option = {
		name = "æ“¦å›æ”¶"
        # æ•ˆæœï¼šæ‰“é’±
		add_gold = { value = 1000000 }
	}
	# é€‰é¡¹äºŒï¼šè§¦å‘å¦ä¸€ä¸ªè‡ªå®šä¹‰äº‹ä»¶
	option = {
		name = "ddd"
		trigger_event_non_silently = { id = manual_rename_fix.4 }
	}
}
manual_rename_fix.4 = {
    type = country_event
    title = "å®¶æ—æˆå‘˜æ›´å"
    desc = "æˆ‘ä»¬æ­£åœ¨å°è¯•ä¸ºçš‡å®¤åè£”é‡æ–°å‘½åã€‚"
    is_triggered_only = yes
    immediate = {
        # 1. é”å®šç»Ÿæ²»è€…
        if = {
            limit = { has_ruler = yes }
            ruler ?= { save_scope_as = current_ruler }
        }
    }
	# é€‰é¡¹1ï¼šæœ‰æ•ˆ
    option = {
        name = "ä¸ºéšæœºå­å¥³æ”¹å"
        scope:current_ruler = {
            # 2. è¿›å…¥å­å¥³ä½œç”¨åŸŸ
            Â· = {
                limit = { is_alive = yes }
                save_scope_as = target_descendant
                set_first_name = "é™é•œ" 
            }
        }
        add_gold = 1000 
    }
	# é€‰é¡¹2ï¼šç»™ç»§æ‰¿äººæ”¹åï¼ˆä¿®æ­£ç‰ˆï¼Œæœ‰æ•ˆï¼‰
    option = {
        name = "ç»™ç»§æ‰¿äººæ”¹å"
        # å»ºè®®å…ˆåˆ‡åˆ°ç»Ÿæ²»è€…ï¼Œå†æ‰¾ä»–çš„ç»§æ‰¿äººï¼Œè¿™æ ·æœ€ç¨³å¦¥
        scope:current_ruler = {
            primary_heir = {
                set_first_name = "å¸"
            }
        }
        # å¦‚æœä¸Šé¢ä¸ç”Ÿæ•ˆï¼Œå°è¯•ç›´æ¥ä½¿ç”¨ country ä½œç”¨åŸŸä¸‹çš„ primary_heir
        # primary_heir = { set_first_name = "å¸" }
    }
    # é€‰é¡¹3ï¼šç»™é•¿å­æ”¹åï¼ˆä¿®æ­£ç‰ˆï¼Œæœ‰æ•ˆï¼Œä½†ä¸€ç›´æ˜¯è€å¤§ï¼‰
    option = {
        name = "ç»™é•¿å­æ”¹å"
        # å¿…é¡»åœ¨çˆ¶æ¯çš„ä½œç”¨åŸŸä¸‹ä½¿ç”¨ ordered_child
        scope:current_ruler = {
            ordered_child = {
                index = 0 # ç¬¬ä¸€ä¸ªå­å¥³ï¼Œé»˜è®¤æ˜¯é•¿å­ï¼Œ è¿™ä¸ªå…¶å®æ²¡ç”¨ï¼Œæ”¹ä»€ä¹ˆéƒ½ä¸€æ ·æ˜¯ç¬¬ä¸€ä¸ªå­å¥³
                set_first_name = "å¸"
            }
        }
    }
	# é€‰é¡¹3ï¼šç»™æ¬¡å­æ”¹åï¼ˆä¿®æ­£ç‰ˆï¼Œæ‹¿åˆ°é•¿å­ï¼‰
    option = {
        name = "ç»™é•¿å­æ”¹å"
        # å¿…é¡»åœ¨çˆ¶æ¯çš„ä½œç”¨åŸŸä¸‹ä½¿ç”¨ ordered_child
        scope:current_ruler = {
            ordered_child = {
                index = 1
                set_first_name = "ç¾"
            }
        }
    }
}
# åºŸæ¡ˆ
manual_rename_fix.5 = {
	type = country_event
	title = "çš‡æ—æˆå‘˜åå•"
	desc = "å¦‚æœä¸‹æ–¹ä¾ç„¶æ²¡æœ‰é€‰é¡¹ï¼Œè¯·ç¡®è®¤ç»Ÿæ²»è€…æ˜¯å¦æœ‰æ´»ç€çš„å­å­™ã€‚"
	is_triggered_only = yes
	# --- é€»è¾‘æ ¸å¿ƒï¼šç›´æ¥åœ¨é€‰é¡¹é‡Œä½¿ç”¨ every_child ---
	# é€‰é¡¹ 1ï¼šåˆ—å‡ºæ‰€æœ‰ç›´ç³»å­å¥³
	option = {
		name = "ã€æŸ¥çœ‹æ‰€æœ‰å­å¥³ã€‘"
		ruler = {
			every_child = {
				limit = { is_alive = yes }
				# å¼ºåˆ¶æ”¹å
				set_first_name = "é™é•œ11"
				# è¾…åŠ©åé¦ˆï¼šæ¯æ”¹ä¸€ä¸ªåŠ 100é‡‘å¸
				owner = { add_gold = 100 }
			}
		}
	}
	# é€‰é¡¹ 2ï¼šåˆ—å‡ºæ‰€æœ‰å­™è¾ˆï¼ˆå¹³é“ºæ”¹åï¼‰
	option = {
		name = "ã€å°è¯•ä¿®æ”¹æ‰€æœ‰å­™è¾ˆã€‘"
		ruler = {
			every_child = {
				limit = { is_alive = yes }
				every_child = {
					limit = { is_alive = yes }
					set_first_name = "é™é•œ"
					owner = { add_gold = 50 }
				}
			}
		}
	}
	# --- é’ˆå¯¹ä½ è¦æ±‚çš„â€œåˆ—å‡ºåå­—ç‚¹å‡»â€ ---
	# å¦‚æœ dynamic_child_option è¿˜æ˜¯ä¸æ˜¾ç¤ºï¼Œæˆ‘ä»¬æ”¹ç”¨è¿™ç§å†™æ³•ï¼š
	dynamic_child_option = {
		scope = ruler
		item = {
			name = "å­ï¼š[scope:child.GetFirstName]"
			scope:child = { set_first_name = "é™é•œ" }
		}
	}
	# åµŒå¥—æ˜¾ç¤ºå­™è¾ˆ
	immediate = {
		ruler = {
			every_child = {
				limit = { is_alive = yes }
				save_scope_as = current_son
			}
		}
	}
	# å†æ¬¡å°è¯•ä¸ºæ¯ä¸ªå„¿å­åä¸‹çš„å­™å­ç”ŸæˆåŠ¨æ€æŒ‰é’®
	dynamic_child_option = {
		scope = scope:current_son
		item = {
			name = "å­™ï¼š[scope:child.GetFirstName]ï¼ˆ[scope:current_son.GetFirstName]ä¹‹å­ï¼‰"
			scope:child = { set_first_name = "é™é•œ" }
		}
	}
	option = {
		name = "å…³é—­çª—å£"
	}
}
manual_rename_fix.6 = {
	type = country_event
	title = "èµåç³»ç»Ÿ"
	desc = "è¯·åœ¨ä¸‹æ–¹åˆ—è¡¨ä¸­é€‰æ‹©ä¸€åæˆå‘˜è¿›è¡Œæ”¹åï¼š"
	is_triggered_only = yes
	# --- ç¬¬ä¸€éƒ¨åˆ†ï¼šåˆ—å‡ºæ¯ä¸€ä¸ªå­å¥³ä¸ºç‹¬ç«‹é€‰é¡¹ ---
	dynamic_child_option = {
		scope = ruler
		item = {
			name = "èµå(å­)ï¼š[scope:child.GetFirstName]"
			scope:child = {
				set_first_name = "é™é•œ"
			}
			# åé¦ˆï¼šåªæœ‰ç‚¹ä¸­çš„é‚£ä¸ªäººä¼šè®©ä½ åŠ é’±
			owner = { add_gold = 100 } 
		}
	}
	# --- ç¬¬äºŒéƒ¨åˆ†ï¼šåˆ—å‡ºæ¯ä¸€ä¸ªå­™è¾ˆä¸ºç‹¬ç«‹é€‰é¡¹ ---
	# æ ¸å¿ƒæŠ€å·§ï¼šé€šè¿‡æ¯ä¸€ä¸ªå­è¾ˆçš„ä½œç”¨åŸŸï¼ŒåŠ¨æ€ç”Ÿæˆä»–ä»¬åä»£çš„æŒ‰é’®
	immediate = {
		ruler = {
			save_scope_as = current_ruler
		}
	}
	# éå†æ¯ä¸ªå„¿å­ï¼Œä¸ºä»–ä»¬çš„å­©å­ç”ŸæˆæŒ‰é’®
	# æ³¨æ„ï¼šdynamic_child_option æ”¾åœ¨ every_child å†…éƒ¨å¯ä»¥å®ç°å¹³é“ºæ‰€æœ‰å­™å­
    # è¿™ä¸ªæœ‰ç”¨ï¼Œæ‰€æœ‰äººå…¨æ”¹äº†
	every_child = {
		limit = { is_alive = yes }
		save_scope_as = active_son # é”å®šå½“å‰çš„å„¿å­
		# åµŒå¥—ç”Ÿæˆå­™å­çš„é€‰é¡¹
		dynamic_child_option = {
			scope = scope:active_son
			item = {
				name = "èµå(å­™)ï¼š[scope:child.GetFirstName] ([scope:active_son.GetFirstName]ä¹‹å­)"
				scope:child = {
					set_first_name = "é™é•œ"
				}
				owner = { add_gold = 50 }
			}
		}
	}
	option = {
		name = "æˆ‘å†æƒ³æƒ³ï¼ˆå…³é—­ï¼‰"
	}
}
```
äº‹ä»¶å¼€å‘æ—¶ï¼Œå¦‚æœæœ‰å¤§æ®µé‡å¤çš„ä»£ç ï¼Œå»ºè®®æå–æˆå‡½æ•°ï¼Œé¿å…é‡å¤ç¼–å†™ã€‚

å‡½æ•°å£°æ˜ä½ç½®ï¼šin_game/common/scripted_effects/rename_effects.txt

scripted_effects æœ¬è´¨å°±æ˜¯å¤šä¸ªæ•ˆæœçš„é›†åˆã€‚[æ–‡æ¡£](https://eu5.paradoxwikis.com/Macro)

```
# å®šä¹‰ä¸€ä¸ªåä¸º input_number_digit çš„â€œå‡½æ•°â€
# ä½¿ç”¨ $DIGIT$ ä½œä¸ºå‚æ•°å ä½ç¬¦
input_number_digit = {
	change_global_variable = { 
		name = pinyin_code 
		multiply = 10 
	}
	change_global_variable = { 
		name = pinyin_code 
		add = $DIGIT$
	}
}
# äº‹ä»¶ä¸­è°ƒç”¨
option = {
    name = "0"
    scope:recipient = { input_number_digit = { DIGIT = 0 } }
    trigger_event_non_silently = { id = tests_event.4 }
}
```
æ§åˆ¶å°è°ƒç”¨äº‹ä»¶ï¼š`event tests_event.4`

## æ•ˆæœ effect
[æ–‡æ¡£](https://eu5.paradoxwikis.com/Effect)
- æŒ‡å®šå›½å®¶èŒƒå›´ï¼š
    è¯­æ³•ï¼šc:[å›½å®¶TAG] eg: c:MNG // æŒ‡å®šå›½å®¶å¤§æ˜
    ```
    # æ§åˆ¶å°æ‰§è¡Œ å›½å®¶ åå­— ä» æ˜ å˜æˆäº† æ˜æœ
    effect c:MNG = { change_country_name = "æ˜æœ" }
    ```
- æ§åˆ¶å°å¯¹å…¨å±€å˜é‡çš„æ“ä½œï¼š
    è¯­æ³•ï¼š
    ```
        # è®¾ç½®å…¨å±€å˜é‡
        effect set_global_variable = { name = [å˜é‡å] value = [å€¼] }
        # åˆ é™¤å…¨å±€å˜é‡
        effect remove_global_variable = [å˜é‡å]
    ```
    ç¤ºä¾‹ï¼š
    ```
    # æ§åˆ¶å°æ‰§è¡Œ å…¨å±€å˜é‡ test_var å€¼ 100
    effect set_global_variable = { name = test_var value = 100 }
    # æ§åˆ¶å°æ‰§è¡Œ åˆ é™¤å…¨å±€å˜é‡ test_var
    effect remove_global_variable = test_var
    ```
## å›¾å½¢ç•Œé¢ GUI
ä½ç½®ï¼šin_game/gui/xxx.gui [æ–‡æ¡£](https://eu5.paradoxwikis.com/Interface_modding_guide)

æ¯ä¸€ä¸ªç‹¬ç«‹çš„guiæ–‡ä»¶éƒ½éœ€è¦ä¸€ä¸ªwindowã€‚åŒæ ·çš„è¿™ä¸ªwindowå¿…é¡»æœ‰ä¸€ä¸ªnameå±æ€§ã€‚

ç¼–å†™ä¸€ä¸ªguiæ–‡ä»¶åï¼Œéœ€è¦åœ¨guiç›®å½•ä¸‹åˆ›å»ºscripted_widgetsæ–‡ä»¶å¤¹ï¼Œæ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ªtxtæ–‡ä»¶ç”¨æ¥æ³¨å†Œè¿™ä¸ªguiæ–‡ä»¶ã€‚

```
# tiandao_rename.gui
window = { name = "tiandao_rename" }
# æ³¨å†Œguiæ–‡ä»¶ scripted_widgets/tiandao_widgets.txt æ–‡ä»¶åå­—æ— æ‰€è°“
# å‘Šè¯‰å¼•æ“ï¼šè¿™ä¸ª GUI åå­—å« tiandao_renameï¼Œå¯¹åº”çš„æ–‡ä»¶æ˜¯ gui/tiandao_rename.gui
gui/tiandao_rename.gui = tiandao_rename
```
**Web â†’ Jomini GUI å¿ƒæ™ºæ¨¡å‹ Â· åŠ å¼ºç‰ˆé€ŸæŸ¥è¡¨**
| Web æ¦‚å¿µ | Jomini GUI å¯¹åº”ç‰© | æ˜¯å¦äº¤äº’ | å¸¸ç”¨å±æ€§ | æ€§èƒ½ / ä½¿ç”¨å¤‡æ³¨ |
|---------|------------------|----------|----------|------------------|
| `<div>` | `vbox / hbox` | âŒ | `size` `margin` `padding` `spacing` | **æœ€æ ¸å¿ƒå¸ƒå±€å•ä½**ï¼›Jomini å¼ºåˆ¶æ˜¾å¼å¸ƒå±€ï¼Œç¦æ­¢â€œè‡ªåŠ¨æµå¼â€ |
| `<select>` | `drop_down` | âœ… | `items` `onchange` `selected` | **éå¸¸é‡**ï¼›é¢‘ç¹åˆ·æ–°ä¼šå¡ï¼Œç®€å•é€‰æ‹©å»ºè®®ç”¨å¤šä¸ª `button` |
| `<input>` | `editbox` | âœ… | `text` `maxlength` `onenter` | æ–‡æœ¬è¾“å…¥å”¯ä¸€è§£ï¼›é€šå¸¸é…åˆ `VariableSystem` |
| `<button>` | `button` | âœ… | `onclick` `enabled` `tooltip` | æœ€å®‰å…¨ã€æœ€è½»é‡çš„äº¤äº’ç»„ä»¶ï¼Œ**èƒ½ç”¨æŒ‰é’®å°±åˆ«ç”¨ drop_down** |
| `<img>` | `icon` | âŒ / âœ… | `sprite` `size` `tooltip` | ä¸€åˆ‡å›¾ç‰‡éƒ½æ˜¯ iconï¼›å¯ç»‘å®š tooltip å½“â€œå¯æ‚¬åœå…ƒç´ â€ |
| `<span>` | `text_single` | âŒ | `text` `tooltip` | å•è¡Œæ–‡æœ¬ï¼Œ**ä¸ä¼šè‡ªåŠ¨æ¢è¡Œ**ï¼Œå®½åº¦ä¸å¤Ÿä¼šè£ |
| `<p>` | `text_multi` | âŒ | `text` `max_width` | å¤šè¡Œè‡ªåŠ¨æ¢è¡Œï¼›é•¿è¯´æ˜ / æè¿°å¿…ç”¨ |
| `<ul> / <li>` | `fixedgrid` | âŒ | `columns` `itemsize` | å›ºå®šæ•°é‡ / é™æ€åˆ—è¡¨ï¼Œæ€§èƒ½å¥½ |
| `<ul> / <li>` | `dynamicgrid` | âŒ | `item_template` `datacontext` | åŠ¨æ€åˆ—è¡¨ï¼Œç±»ä¼¼ `v-for`ï¼Œ**æ•°æ®é‡å¤§ä¼šå¡** |
| `<template>` | `item_template` | âŒ | `datacontext` | ä¸“ç»™ `dynamicgrid` ç”¨çš„â€œå­æ¨¡æ¿â€ |
| `v-if` | `visible` | âŒ | `visible` | ä¸å¯è§ â‰  ä¸åˆ›å»ºï¼›å¤æ‚ GUI è¦æ³¨æ„å±‚çº§ |
| `:disabled` | `enabled` | âŒ | `enabled` | false æ—¶ä»å ä½ï¼Œåªæ˜¯ä¸èƒ½ç‚¹ |
| `@click` | `onclick` | âœ… | `onclick` | å¯æ‰§è¡Œ GUI è„šæœ¬ / æ§åˆ¶å°å‘½ä»¤ |
**å±æ€§é€ŸæŸ¥è¡¨**
> é€‚ç”¨äº EU5 / Jomini GUI  
> ç”¨é€”ï¼šæŸ¥ã€Œè¿™ä¸ªå±æ€§æ˜¯å¹²å˜›çš„ã€ã€Œèƒ½ä¸èƒ½ç”¨ã€ã€Œæœ‰æ²¡æœ‰å‘ã€
---
é€šç”¨å±æ€§ï¼ˆå‡ ä¹æ‰€æœ‰æ§ä»¶ï¼‰

| å±æ€§ | å†™æ³•ç¤ºä¾‹ | è¯´æ˜ |
|----|----|----|
| `size` | `size = { 400 120 }` | å›ºå®šæ§ä»¶å°ºå¯¸ï¼›Jomini **ä¸ä¼šè‡ªåŠ¨è®¡ç®—å¤§å°** |
| `margin` | `margin = { 5 5 10 10 }` | å¤–è¾¹è·ï¼Œå½±å“æ§ä»¶ä¸å¤–éƒ¨çš„è·ç¦» |
| `padding` | `padding = { 4 4 6 6 }` | å†…è¾¹è·ï¼Œå½±å“å†…å®¹ä¸è¾¹æ¡†çš„è·ç¦» |
| `visible` | `visible = "[SomeCondition]"` | æ˜¯å¦æ˜¾ç¤ºï¼›`false` æ—¶**ä¸å å¸ƒå±€ä½ç½®** |
| `enabled` | `enabled = "[SomeCondition]"` | æ˜¯å¦å¯äº¤äº’ï¼›ç¦ç”¨åä»å¯è§ |
| `tooltip` | `tooltip = "[GetTooltip]"` | é¼ æ ‡æ‚¬åœæç¤ºæ–‡æœ¬ |
| `datacontext` | `datacontext = "[GetTooltip]"` | æ•°æ®ä¸Šä¸‹æ–‡ï¼Œé€šå¸¸ç”¨äºç»‘å®šæ•°æ®æ¨¡å‹ |

è¯´æ˜ï¼š
- æ‰€æœ‰è¡¨è¾¾å¼ **å¿…é¡»å†™åœ¨ `[]` ä¸­**
- `visible` â‰  `enabled`
- ä¸å­˜åœ¨ `display: none` è¿™ç§è¡Œä¸º
---
å¸ƒå±€æ§ä»¶ï¼ˆ`vbox / hbox`ï¼‰

| å±æ€§ | å†™æ³•ç¤ºä¾‹ | è¯´æ˜ |
|----|----|----|
| `spacing` | `spacing = 8` | å­å…ƒç´ ä¹‹é—´çš„é—´è·ï¼ˆæœ€å¸¸ç”¨ï¼‰ |
| `size` | `size = { 400 300 }` | å¸ƒå±€å®¹å™¨å°ºå¯¸ï¼Œé€šå¸¸å¿…é¡»æ˜¾å¼å†™ |
| `margin` | `margin = { 5 5 }` | æ•´ä¸ªå¸ƒå±€å—ä¸å¤–éƒ¨çš„è·ç¦» |

è¯´æ˜ï¼š
- Jomini **æ²¡æœ‰è‡ªåŠ¨æµå¼å¸ƒå±€**
- æ²¡æœ‰ `flex / grid / justify / align`
- ä¸€åˆ‡æ’ç‰ˆé  `vbox / hbox + size + spacing`
---

æ–‡æœ¬æ§ä»¶

1ï¸âƒ£ `text_single`ï¼ˆå•è¡Œæ–‡æœ¬ï¼‰

| å±æ€§ | å†™æ³•ç¤ºä¾‹ | è¯´æ˜ |
|----|----|----|
| `text` | `text = "MY_TEXT_KEY"` | æ–‡æœ¬å†…å®¹ï¼ˆé€šå¸¸æ˜¯ localization keyï¼‰ |
| `max_width` | `max_width = 300` | æœ€å¤§å®½åº¦ï¼Œè¶…å‡ºä¼šè¢«è£å‰ª |
| `tooltip` | `tooltip = "[GetTooltip]"` | æ‚¬åœæç¤º |

è¯´æ˜ï¼š
- **å•è¡Œ**
- ä¸æ”¯æŒè‡ªåŠ¨æ¢è¡Œ
- å®½åº¦ä¸å¤Ÿä¼šç›´æ¥æˆªæ–­

---

2ï¸âƒ£ `text_multi`ï¼ˆå¤šè¡Œæ–‡æœ¬ï¼‰

| å±æ€§ | å†™æ³•ç¤ºä¾‹ | è¯´æ˜ |
|----|----|----|
| `text` | `text = "MY_LONG_TEXT"` | å¤šè¡Œæ–‡æœ¬å†…å®¹ |
| `max_width` | `max_width = 400` | è¾¾åˆ°å®½åº¦åè‡ªåŠ¨æ¢è¡Œ |

è¯´æ˜ï¼š
- æ”¯æŒè‡ªåŠ¨æ¢è¡Œ
- é€‚åˆæè¿° / è¯´æ˜ / äº‹ä»¶æ–‡æœ¬

---

æŒ‰é’®ï¼ˆ`button`ï¼‰

| å±æ€§ | å†™æ³•ç¤ºä¾‹ | è¯´æ˜ |
|----|----|----|
| `text` | `text = "CONFIRM"` | æŒ‰é’®æ–‡å­— |
| `onclick` | `onclick = "[DoSomething]"` | ç‚¹å‡»äº‹ä»¶ï¼ˆGUI è„šæœ¬ï¼‰ |
| `enabled` | `enabled = "[CanClick]"` | æ˜¯å¦å¯ç‚¹å‡» |
| `tooltip` | `tooltip = "[WhyDisabled]"` | ç¦ç”¨åŸå› è¯´æ˜ |

é«˜çº§ç”¨æ³•ï¼š

```gui
# è°ƒç”¨æ§åˆ¶å°å‘½ä»¤
onclick = "[ExecuteConsoleCommand('effect ...')]"
# ExecuteConsoleCommand åªèƒ½è°ƒç”¨ä¸€ä¸ª
# ExecuteConsoleCommands å¯ä»¥è°ƒç”¨å¤šä¸ªï¼Œä»¥`;`éš”å¼€ å¦‚æœå…¶ä¸­ä¸€ä¸ªæŠ¥é”™ï¼Œåé¢çš„å°±ä¸ä¼šæ‰§è¡Œ
# ExecuteConsoleCommandsForced å¯ä»¥è°ƒç”¨å¤šä¸ªï¼Œä»¥`;`éš”å¼€ å¦‚æœå…¶ä¸­ä¸€ä¸ªæŠ¥é”™ï¼Œåé¢çš„ä¼šç»§ç»­æ‰§è¡Œ
```
è¯´æ˜ï¼š
- button æ˜¯ æœ€è½»é‡ã€æœ€å®‰å…¨çš„äº¤äº’æ§ä»¶
- èƒ½ç”¨æŒ‰é’®å°±ä¸è¦ç”¨ drop_down

---

è¾“å…¥æ¡†ï¼ˆ`editbox_single`ï¼‰

| å±æ€§ | å†™æ³•ç¤ºä¾‹ | è¯´æ˜ |
|----|----|----|
| `size` | `size = { 300 30 }` | è¾“å…¥æ¡†å°ºå¯¸ |
| `editbox_label` | `blockoverride "editbox_label" { text = "è¯·è¾“å…¥..." }` | placeholderï¼ˆæ’æ§½ï¼‰ |
| `maxcharacters` | `maxcharacters = 10` | æœ€å¤§è¾“å…¥å­—ç¬¦æ•° |
| `raw_text` | `raw_text = "[GetVariableSystem.Get('input_content')]"` | è¾“å…¥æ¡†å†…å®¹ï¼ˆè¡¨è¾¾å¼ï¼‰ |
| `ontextedited` | `ontextedited = "[GetVariableSystem.Set('input_content', GetTextFromSelfOrAnyChildEditbox(PdxGuiWidget.Self))]"` | è¾“å…¥æ¡†å†…å®¹å˜åŒ–æ—¶è§¦å‘ |

---

å›¾åƒ (`icon`)

| å±æ€§ | å†™æ³•ç¤ºä¾‹ | è¯´æ˜ |
|----|----|----|
| `sprite` | `sprite = "GFX_flag_fra"` | å›¾ç‰‡èµ„æº |
| `size` | `size = { 32 32 }` | å›¾åƒå°ºå¯¸ |

è¯´æ˜ï¼š
- Jomini ä¸­ æ‰€æœ‰å›¾ç‰‡éƒ½æ˜¯ icon
- å›½æ—— / äººç‰© / UI å›¾æ ‡ç»Ÿä¸€æœºåˆ¶

---

åˆ—è¡¨ (`dynamicgrid`)

| å±æ€§ | å†™æ³•ç¤ºä¾‹ | è¯´æ˜ |
|----|----|----|
| `item_template` | `item_template = "item_template"` | å­é¡¹æ¨¡æ¿ |
| `datacontext` | `datacontext = "[GetCountryList]"` | æ•°æ®æ¥æº |

è¯´æ˜ï¼š
- åŠ¨æ€åˆ—è¡¨ï¼Œæ ¹æ®æ•°æ®åŠ¨æ€ç”Ÿæˆå­é¡¹
- æ¯ä¸ªå­é¡¹éƒ½æ˜¯ä¸€ä¸ª `item_template` çš„å®ä¾‹
- æ•°æ®é‡å¤§å®¹æ˜“å¡
- èƒ½ç”¨ fixedgrid å°±åˆ«ç”¨ dynamicgrid

---

ä¸‹æ‹‰æ¡† (`drop_down`)

ç¤ºä¾‹ï¼š
```
drop_down = {
    name = "tiandao_attr_selector"
    size = { 150 30 }
    # å½“å‰é€‰ä¸­çš„æ˜¾ç¤ºå†…å®¹ (ç±»ä¼¼ selected value)
    active_item = {
        widget_standard = {
            size = { 100% 100% }
            text_single = { text = "å½“å‰é€‰æ‹©çš„å±æ€§" }
        }
    }
    # å±•å¼€åçš„ä¸‹æ‹‰åˆ—è¡¨ (ç±»ä¼¼ options)
    item_adapter = {
        list = {
            # è¿™é‡Œé€šå¸¸éœ€è¦ç»‘å®šä¸€ä¸ª DataModel
            datamodel = "[GetPlayer.GetCustomList]" 
            item = {
                widget_standard = {
                    # ç‚¹å‡»é€‰é¡¹åçš„é€»è¾‘
                    button_normal = { onclick = "[...]" }
                }
            }
        }
    }
}
```
è¯´æ˜ï¼š
- ä¸‹æ‹‰æ¡†ï¼Œæ€§èƒ½å¼€é”€ `éå¸¸å¤§`
- ä¸é€‚åˆé«˜é¢‘åˆ·æ–°
- å°åŠŸèƒ½å»ºè®®æ‹†æˆå¤šä¸ª `button`

---

çª—å£ (`window`)

| å±æ€§ | å†™æ³•ç¤ºä¾‹ | è¯´æ˜ |
|----|----|----|
| `parentanchor` | `parentanchor = center` | çª—å£å±…ä¸­ |
| `allow_outside` | `allow_outside = yes` | æ˜¯å¦å…è®¸è¶…å‡ºçˆ¶å®¹å™¨ |
| `title` | `title = "My Window"` | çª—å£æ ‡é¢˜ |

---

gui çš„ä¸€ä¸ªwindowç±»ä¼¼htmlçš„htmlæ ‡ç­¾ï¼Œæ˜¯guiçš„é‡è¦å…¥å£ã€‚

åŒæ—¶ï¼Œå¦‚æœæœ‰å¤§é‡çš„ç›¸ä¼¼ç»“æ„ï¼Œå¯ä»¥ä½¿ç”¨typs æˆ–è€… template æ¥å‡å°‘é‡å¤ä»£ç ã€‚

type ç±»ä¼¼ç»„ä»¶ï¼Œå¯ä»¥åœ¨å¤šä¸ªguiæ–‡ä»¶ä¸­è¿è¡Œ

```
# component.gui
types ComponentTypes = {
    type app_button = hbox {
        layoutpolicy_horizontal = expanding
        margin = {5 0}
        visible = yes
        button_regular_diamond = {
            name = "decline_button"
            tooltip_enabled = no
            text = "å–æ¶ˆ"
            using = button_resize_to_fit_text
            using = snd_UI_close
            # å®šä¹‰å¯ä»¥è¢«è¦†ç›–çš„å—ï¼Œç±»ä¼¼ vueä¸­ çš„å…·åæ’æ§½
            block "on_cancel_click" {
                onclick = "[GetScriptedGui('close_tiandao_input_modal_sgui').Execute(GuiScope.SetRoot(GetPlayer.MakeScope).End)]"
            }
        }
    }
}
# ä½¿ç”¨ component.gui ä¸­çš„ app_button ç»„ä»¶
app_button = {
    # é€šè¿‡ blockoverride è¦†ç›– on_confirm_click å—
    blockoverride "on_confirm_click" {
        onclick = "[GetScriptedGui('close_tiandao_input_modal_sgui').Execute(GuiScope.SetRoot(GetPlayer.MakeScope).End)]"
    }
}

```
type ç±»ä¼¼ç»„ä»¶ï¼Œå¯ä»¥åœ¨å¤šä¸ªguiæ–‡ä»¶ä¸­è¿è¡Œ

```
# ç¼–å†™
template tiandao_glow_style {
    glow = { color = { 1 0.8 0 1 } glow_radius = 5 }
    alwaystransparent = yes
}

# ä½¿ç”¨æ—¶ï¼š
icon = {
    size = { 100% 100% }
    using = tiandao_glow_style # è°ƒç”¨
}

```
ğŸ§¬ è¿›é˜¶å¤ç”¨ï¼šType vs Template

- 1. Type (ç»„ä»¶)
    - **ç”¨é€”**: å®šä¹‰æ–°ç»“æ„ (New Tags)ã€‚
    - **è°ƒç”¨**: ç›´æ¥ä½œä¸ºæ ‡ç­¾åä½¿ç”¨ï¼Œå¦‚ `tiandao_input_modal = {}`ã€‚
    - **æ ¸å¿ƒ**: æ”¯æŒ `blockoverride` æ’æ§½ï¼Œé€‚åˆå¤æ‚çš„ UI æ¨¡å—ã€‚
- 2. Template (æ ·å¼/å®)
    - **ç”¨é€”**: å®šä¹‰å±æ€§é›†åˆ (CSS Classes)ã€‚
    - **è°ƒç”¨**: åœ¨å·²æœ‰æ§ä»¶å†…ä½¿ç”¨ `using = template_name`ã€‚
    - **æ ¸å¿ƒ**: é€‚åˆå¤ç”¨åŠ¨ç”»ã€è¾¹è·ã€é¢œè‰²ã€å­—ä½“æ ·å¼ç­‰åŸå­å±æ€§ã€‚
- ğŸ’¡ å¼€å‘å»ºè®®
    - å¤æ‚çš„ UI å—å°è£…ä¸º **Type**ã€‚
    - ç»Ÿä¸€çš„è§†è§‰è§„èŒƒï¼ˆå¦‚é‡‘è‰²æ–‡å­—ã€é˜´å½±æ•ˆæœï¼‰å°è£…ä¸º **Template**ã€‚

ç®€å•è¯´ï¼Œä¸€ä¸ªæ˜¯ç»„ä»¶ï¼Œå¯ä»¥æŒ‡å®šéƒ¨åˆ†å†…å®¹è¢«è‡ªå®šä¹‰æ›¿æ¢å®ç°å·®å¼‚åŒ–ã€‚ä¸€ä¸ªæ˜¯çº¯ç²¹çš„ç›´æ¥å¤ç”¨ï¼Œæ²¡æœ‰äº¤äº’ï¼Œæ²¡æœ‰è¦†ç›–ã€‚å†…å®¹å®Œå…¨ç›¸åŒã€‚

```
# æ¨¡æ‹Ÿä¸€ä¸ªå¸¦è¾¹æ¡†å’Œå†…è¾¹è·çš„ div
type tiandao_div = widget {
    size = { 100% 200 } # å¿…é¡»ç»™é«˜åº¦ï¼Œæˆ–è€…ç”¨ layoutpolicy
    
    # èƒŒæ™¯å’Œè¾¹æ¡† (CSS background/border)
    background = {
        using = background_area_dark # ä½¿ç”¨æ¸¸æˆå†…ç½®æ ·å¼
        margin = { 5 5 }
    }
    
    # å†…éƒ¨å¸ƒå±€ (CSS padding/flex)
    vbox = {
        margin = { 10 10 }
        spacing = 5
        
        block "content" {} # å…·åæ’æ§½
    }
}
```
åœ¨æ§åˆ¶å°é‡Œè°ƒç”¨guiçš„æ–¹æ³•ï¼š
```
# åˆ›å»ºçª—å£
gui.CreateWidget gui/tiandao_nickname.gui tiandao_nickname
# æ¸…é™¤æ‰€æœ‰çª—å£
gui.ClearWidgets
```

## è„šæœ¬åŒ–GUI
ä½ç½®ï¼šin_game/common/scripted_guis/use_tiandao_sgui.txt [æ–‡æ¡£](https://eu5.paradoxwikis.com/Scripted_gui)

guiç•Œé¢è§¦å‘äº¤äº’æ—¶è¦æ‰§è¡Œçš„å†…å®¹å°±å¯ä»¥æ”¾åœ¨è¿™é‡Œã€‚æ¯”å¦‚æ‰§è¡Œè§¦å‘`äº‹ä»¶ã€æ•ˆæœ`ç­‰ç­‰ã€‚

```
# å…³é—­å¼¹çª—
close_tiandao_input_modal_sgui = {
    scope = country
    effect = {
        # ç›´æ¥åœ¨è¿™é‡Œæ¸…é™¤å…¨å±€å˜é‡
        remove_global_variable = show_tiandao_input_modal
        remove_global_variable = tiandao_current_target
    }
}
# gui ä¸­è°ƒç”¨
onclick = "[GetScriptedGui('close_tiandao_input_modal_sgui').Execute(GuiScope.SetRoot(GetPlayer.MakeScope).End)]"
```

## å…¶ä»–
- æ§åˆ¶å°é‡è½½æ–‡ä»¶ debug æ¨¡å¼ä¸‹ä¸ç”¨æ‰‹åŠ¨æ‰§è¡Œï¼Œæ¸¸æˆä¼šè‡ªåŠ¨é‡è½½ï¼Œçƒ­æ›´æ–°
    - reload localization é‡æ–°åŠ è½½æœ¬åœ°åŒ–æ–‡ä»¶
    - reload gui é‡æ–°åŠ è½½ GUI æ–‡ä»¶
    - reload script é‡æ–°åŠ è½½ Script / Effect / Trigger
    - reload textures é‡æ–°åŠ è½½èµ„æºæ–‡ä»¶ï¼šå›½æ—— / icon / å›¾ç‰‡
    - reload event é‡æ–°åŠ è½½äº‹ä»¶æ–‡ä»¶
- æŸ¥çœ‹è§’è‰²ç›¸å…³å‡½æ•°
    æ§åˆ¶å°ï¼Œè¾“å…¥ explorer
    åœ¨å¼¹å‡ºçš„ Object Explorer çª—å£ä¸­ï¼Œåœ¨ Providers é€‰æ‹© data Types é€‰é¡¹ã€‚
    æ‰¾åˆ°Character, èƒ½çœ‹åˆ°è§’è‰²ç›¸å…³çš„æ‰€æœ‰å‡½æ•°ï¼Œeg: GetName
    åŒç†ï¼Œæ‰¾åˆ°Country, èƒ½çœ‹åˆ°å›½å®¶ç›¸å…³çš„æ‰€æœ‰å‡½æ•°ï¼Œeg: GetName
- UI å¿«é€Ÿå®šä½
    å¼€å¯æ§åˆ¶å°åï¼ŒæŒ‰ä¸‹å¿«æ·é”® `ctrl + z`, é¼ æ ‡ç§»åŠ¨åˆ°uiä¸Šå°±è¡Œã€‚